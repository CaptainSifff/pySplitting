---

title: pySplitting

keywords: fastai
sidebar: home_sidebar

summary: "A project to have python code that generates the order conditions for exponential splitting methods with the techniques of M. Thalhammer."
description: "A project to have python code that generates the order conditions for exponential splitting methods with the techniques of M. Thalhammer."
nb_path: "index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pip pySplitting</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-use">How to use<a class="anchor-link" href="#How-to-use"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is a python project that generates the equations for the order conditions such that exponential splitting methods of the given order or with the desired features can be designed. To that end we utilize sympy to get symbolic expressions that can be further processed.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we will derive the equations for the familiar leapfrog/Strang splitting. This is a method of order p=2 and uses the indeterminates ((t0,t1),(v0,v1))=((1/2,1/2).(1,0)). Hence we have to set up sympy first to give us the respective symbols:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sympy.matrices.dense</span> <span class="kn">import</span> <span class="n">symarray</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">tvec</span><span class="o">=</span><span class="p">[</span><span class="o">*</span><span class="n">symarray</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span>
<span class="n">vvec</span><span class="o">=</span><span class="p">[</span><span class="o">*</span><span class="n">symarray</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next we build the equations. To that end we use the function CreateCondition().
The first argument is the order, the second and third argument are the indeterminates for the resulting polynomials.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">strangconds</span><span class="o">=</span><span class="n">CreateConditions</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">tvec</span><span class="p">,</span><span class="n">vvec</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">strangconds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea ">
<pre>[Eq(t_0 + t_1, 1), Eq(-v_0 - v_1 + 1, 0), Eq(-t_0*v_0 - v_1 + 1/2, 0)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we check wether the solutions fulfill these equations:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">it</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="s1">&#39;t_0&#39;</span><span class="p">,</span><span class="n">sympify</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),(</span><span class="s1">&#39;t_1&#39;</span><span class="p">,</span><span class="n">sympify</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),(</span><span class="s1">&#39;v_0&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="s1">&#39;v_1&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span> <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">strangconds</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[True, True, True]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It works! Now we move on to check the improved Leapfrog by McLachlan, and utilize that we can impose already some structure(symmetry and the consistency equations) on the indeterminates to get some simplifications:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tvec</span><span class="o">=</span><span class="p">[</span><span class="o">*</span><span class="n">symarray</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">)]</span>
<span class="n">tvec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">tvec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">tvec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">tvec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">vvec</span><span class="o">=</span><span class="p">[</span><span class="o">*</span><span class="n">symarray</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">)]</span>
<span class="n">vvec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="n">vvec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">vvec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Indeterminates: &quot;</span><span class="p">,</span><span class="n">tvec</span><span class="p">,</span><span class="n">vvec</span><span class="p">)</span>
<span class="n">McLachlanconds</span><span class="o">=</span><span class="n">CreateConditions</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">tvec</span><span class="p">,</span><span class="n">vvec</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">McLachlanconds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Indeterminates:  [t_0, 1 - 2*t_0, t_0] [v_0, v_0, 0]
[True, Eq(1 - 2*v_0, 0), Eq(-t_0*v_0 - v_0*(1 - t_0) + 1/2, 0)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We check that the given numbers(v_0=1/2,t_0=0.1931) satisfy the equation:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">it</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="s1">&#39;t_0&#39;</span><span class="p">,</span><span class="mf">0.19318332</span><span class="p">),(</span><span class="s1">&#39;v_0&#39;</span><span class="p">,</span><span class="n">sympify</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span> <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">McLachlanconds</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[True, True, True]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>True! Now we move on to two more fourth order esamples from the literature:</p>

</div>
</div>
</div>
</div>
 

